# vpn原理简述

## 一、安全原理

###1.加密算法（确保数据是安全的）

* **加密算法概述**

  明文---------->密文

  对称加密算法 vs 非对称加密算法

* **对称加密算法（一般用于真正的数据交换）**

  算法：DES、3DES 、AES、RC4

  （社工库）

  原理：

  特征：

  1. 紧凑性：加密前后文件大小变化不大

           	   2. 速度快
                3. 安全性高
                    4. 密钥管理难
                    5. 不支持数字签名
                    6. 不支持不可否认性

* **非对称加密算法（一般用于密钥交换）**

  算法：RSA、DH、ECC

  原理：

  ​	密钥串：公钥+私钥，私钥加密公钥解，公钥加密私钥解，要将数据包发给谁就用谁的公钥

  特征：

  1. 不可否认性
  2. 支持数字签名
  3. 支持密钥分发

* **对称 + 非对称**

  对称算法用于加密数据（采用对称密钥加密）

  非对称算法用于密码交换（交换对称密钥）

  ​

### 2.哈希算法（解决数据包没有被篡改）

* **哈希算法（hash）分类**

  MD5、SHA

* **哈希算法原理**

  特征：

  1. 雪崩效应：如果明文有任何修改，hash全局改变
  2. 不可逆向：无法根据hash值得到明文
  3. 固定输出：128bit、160bit（Cain & Able可解密简单的密码）

  功能：

  1. 完整性校验
  2. 安全性校验

* 哈希算法的应用

  网盘秒传

  软件下载（安全验证）

  ​

### 3.密钥化散列

* **密钥化散列原理及功能**

  发送方：对明文和共享密钥进行hash计算，得出的HMAC值放在报文后面

  接收方：分离明文，对明文和本地密钥hash计算，比较其HMAC值

  功能：用于实现完整性校验

  ​           实现身份认证

  ​

### 4.数字签名（此数据一定是私钥持有者发送的）

* **数字签名组件**

  HASH算法

  非对称加密算法

* **数字签名原理**

  简述：发送方经过私钥加密的hash值

  发送方：

  1. 签名者对明文进行hash计算
  2. 签名者用本地私钥对hash出来的散列值加密
  3. 加密后的散列值放在密文尾部一起发送出去

  接收方：

  1. 用签名者的公钥解开加密的散列值
  2. 用明文的散列和刚用公钥解开的散列进行对比

* **数字签名功能**

  不可抵赖性：

  ​	用签名者的公钥可以解开HMAC证明数据是签名者发送的

  数据完整性：

  ​	HASH值相同证明明文没有被篡改

  ​

### 5.数字证书（PKI架构）

* **数字证书组成**

  * ​                   CA(公钥+名字+地址+有效期)

    ​	                		|

    ​                     			|

    ​              | ----------------->数字证书---------------------> |

    ​              |                                                                  |

    密文+加密密钥+数字签名---------->密文+加密密钥+数字签名+数字证书

  * 对等公钥

  * 对等姓名、组织、地址

  * 证书有效期

  * CA的数字签名

* **数字证书原理**

  发送方：

  1. 向CA组注册，涉及内容包括：姓名、地址、公钥、数字签名、证书有效期
  2. 向CA获取数字证书，并添加在密文后面

  第三方 CA：

  1. 对对等体的信息进行数字签名-用CA的私钥加密用户信息

  接收方：

  1. 向CA获取公钥，用公钥解开CA的数字签名，对比hash值
  2. 用证书夹带的公钥解开发送者的数字签名，对比hash值

* **PKI架构**

  CA：发证书

  RA：做注册

  数字证书

  对等体（发送方于接收方）

  分发机制

  ​

## 二、进阶

### 1.VPN概念

* SSL VPN（淘宝时数据加密）
* IPsec VPN（最官方应用于企业级）
* PPTP L2TP(翻墙用)



### 2.IPsec原理

* 背景：

  1. 传统专线价格比较高
  2. IPsec VPN基于加密线路传输
  3. 部署非常方便，客户既能够上网又能于分支相互通信
  4. IPsec VPN在企业网络/校园网络分支之间使用

* 基于IPsec：

  L2L-VPN

  DRE over IPsec

  EzVPN

  DMVPN

  HA-VPN

  VPN Combination

* IPsec定义：

  网络层用使用加密传输机制的IETF标准



### 3.IKE原理

###4.ESP详解



## 三、高级

